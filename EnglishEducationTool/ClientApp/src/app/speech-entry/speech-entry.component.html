<mat-drawer-container class="drawer-container">

  <mat-drawer mode="side" opened disableClose position="end">
    <mat-accordion multi="true">
      <mat-expansion-panel expanded>
        <mat-expansion-panel-header>
          <mat-panel-title>
            Check Spelling
          </mat-panel-title>
          <mat-panel-description>
            <div *ngIf="dataSource[0].token != '-'; else elseBlockNum">
              [{{ dataSource.length }}]
            </div>
            <ng-template #elseBlockNum>No Suggestions</ng-template>
          </mat-panel-description>
        </mat-expansion-panel-header>
        <div class="spellcheck-container">
          <p>Entry: {{ wordToProof }}</p>
          <ng-template #elseBlockDescrip></ng-template>
          <table mat-table [dataSource]="dataSource" class="mat-elevation-z1" *ngIf="dataSource[0].token != ''">
            <!--- Note that these columns can be defined in any order.
          The actual rendered columns are set as a property on the row definition" -->
            <!-- Word Column -->
            <ng-container matColumnDef="word">
              <th mat-header-cell *matHeaderCellDef> Word </th>
              <td mat-cell *matCellDef="let element"> {{element.token}} </td>
            </ng-container>
            <!-- Suggestions Column -->
            <ng-container matColumnDef="suggestions">
              <th mat-header-cell *matHeaderCellDef>Suggestions</th>
              <td mat-cell *matCellDef="let element">
                <div>
                  <ng-container *ngFor="let item of element.suggestions">
                    <div>
                      <span>
                        {{ item.suggestionSuggestion }}
                      </span>
                    </div>
                  </ng-container>
                </div>
              </td>
            </ng-container>
            <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
            <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
          </table>
        </div>
      </mat-expansion-panel>

      <div class="definition-container">
        <mat-expansion-panel expanded>
          <mat-expansion-panel-header>
            <mat-panel-title>
              Dictionary
            </mat-panel-title>

            <mat-panel-description>
              <mat-form-field appearance="fill">
                <mat-label>Language</mat-label>
                <select matNativeControl>
                  <option value="english">English</option>
                  <option value="korean">한글</option>
                  <option value="french">French</option>
                </select>
              </mat-form-field>
            </mat-panel-description>
          </mat-expansion-panel-header>

          <mat-form-field appearance="outline">
            <mat-label>Search a word</mat-label>
            <input matInput
                   placeholder="Search..."
                   type="text"
                   autocomplete="off"
                   [formControl]="searchFormControl"
                   pattern="[^\s]*">
            <button mat-button
                    matSuffix
                    (click)="getDefinition()">
              <mat-icon>search</mat-icon>
            </button>
          </mat-form-field>

          <div *ngIf="dicObj[0].word != ''">
            <div class="inline-container">

              <button mat-button
                      (click)="playAudio()">
                <mat-icon>volume_up</mat-icon>
              </button>

              <div id="dic-word">
                <h2><strong>{{ dicObj[0].word }}</strong></h2>
                <h4>{{ dicObj[0].phonetics[0].text }}</h4>
              </div>
            </div>

            <div class="description-container"
                 *ngFor="let dicMeaning of dicObj[0].meanings">
              <h4><i>{{ dicMeaning.partOfSpeech }}</i></h4>
              <p style="margin-bottom: 0;"> {{ dicMeaning.definitions[0].definition }}</p>
              <p style="color: gray;" *ngIf="dicMeaning.definitions[0].example != null"> "{{ dicMeaning.definitions[0].example }}" </p>
            </div>
          </div>
        </mat-expansion-panel>
      </div>
    </mat-accordion>
  </mat-drawer>

  <mat-drawer-content>
    <div class="form-container">
      <div id="form-flex-container">
        <!-- Warning Alert -->
        <div class="alert alert-danger alert-dismissible fade show" *ngIf="badwordWarning">
          <strong>Warning!</strong> Please enter a valid input without the use of profanity.
          <button type="button"
                  class="btn-close"
                  data-bs-dismiss="alert"
                  aria-label="Close"
                  (click)="closeWarning()"></button>
        </div>

        <div id="conversation-history">
          <mat-list dense id="message-list">
            <mat-list-item *ngFor="let message of messages">
              <p> {{ message }} </p>
            </mat-list-item>
          </mat-list>
        </div>

        <div id="input-container">
          <div id="input-flex-container">
            <div class="input-button-container">
              <button mat-fab
                      color="accent"
                      (click)="startService()">
                <mat-icon>mic</mat-icon>
              </button>
            </div>
            <div class="input-button-container">
              <button mat-fab
                      color="basic"
                      (click)="stopListening()">
                <mat-icon>stop</mat-icon>
              </button>
            </div>

            <mat-form-field id="input-full-width">
              <mat-label>Message</mat-label>
              <textarea type="text"
                        matInput
                        [formControl]="inputFormControl"
                        placeholder="Enter message"
                        autocomplete="off"
                        [errorStateMatcher]="matcher"
                        cdkTextareaAutosize
                        #autosize="cdkTextareaAutosize"
                        cdkAutosizeMinRows="1"
                        (input)="this.service.stop(this.inputFormControl.value)"></textarea>

              <mat-error *ngIf="inputFormControl.hasError('required')">
                Message is empty
              </mat-error>

              <mat-error *ngIf="inputFormControl.hasError('maxlength')">
                Message exceeds 140 characters
              </mat-error>

              <mat-hint>{{ inputFormControl.value.length }}/140</mat-hint>
            </mat-form-field>

            <div class="input-button-container">
              <button mat-fab
                      (click)="spellCheckFunc()"
                      color="basic"
                      [disabled]="!inputFormControl.valid">
                <mat-icon>spellcheck</mat-icon>
              </button>
            </div>

            <div class="input-button-container">
              <button mat-fab
                      color="primary"
                      (click)="sendClick()"
                      [disabled]="!inputFormControl.valid">
                <mat-icon>send</mat-icon>
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>

  </mat-drawer-content>
</mat-drawer-container>
